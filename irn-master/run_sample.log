nohup: ignoring input
{'num_workers': 12, 'voc12_root': '/media/crj/irn-master/irn-master/IO/Dataset/VOCdevkit/VOC2012', 'train_list': '/media/crj/irn-master/irn-master/voc12/train_aug.txt', 'val_list': '/media/crj/irn-master/irn-master/voc12/val.txt', 'infer_list': '/media/crj/irn-master/irn-master/voc12/train.txt', 'chainer_eval_set': 'train', 'cam_network': 'net.resnet50_cam', 'cam_crop_size': 512, 'cam_batch_size': 16, 'cam_num_epoches': 5, 'cam_learning_rate': 0.1, 'cam_weight_decay': 0.0001, 'cam_eval_thres': 0.15, 'cam_scales': (1.0, 0.5, 1.5, 2.0), 'conf_fg_thres': 0.3, 'conf_bg_thres': 0.05, 'irn_network': 'net.resnet50_irn', 'irn_crop_size': 512, 'irn_batch_size': 32, 'irn_num_epoches': 3, 'irn_learning_rate': 0.1, 'irn_weight_decay': 0.0001, 'beta': 10, 'exp_times': 8, 'ins_seg_bg_thres': 0.25, 'sem_seg_bg_thres': 0.25, 'log_name': 'sample_train_eval', 'cam_weights_name': 'sess/res50_cam.pth', 'irn_weights_name': 'sess/res50_irn.pth', 'cam_out_dir': 'result/cam', 'ir_label_out_dir': 'result/ir_label', 'sem_seg_out_dir': 'result/sem_seg', 'ins_seg_out_dir': 'result/ins_seg', 'train_cam_pass': True, 'make_cam_pass': True, 'eval_cam_pass': True, 'cam_to_ir_label_pass': True, 'train_irn_pass': True, 'make_ins_seg_pass': True, 'eval_ins_seg_pass': True, 'make_sem_seg_pass': True, 'eval_sem_seg_pass': True}
step.train_cam: Sun Mar  5 17:18:45 2023
Epoch 1/5
step:    0/ 3305 loss:0.7284 imps:4.1 lr: 0.1000 etc:Sun Mar  5 20:56:00 2023
step:  100/ 3305 loss:0.1804 imps:80.7 lr: 0.0973 etc:Sun Mar  5 17:29:41 2023
step:  200/ 3305 loss:0.1158 imps:85.1 lr: 0.0945 etc:Sun Mar  5 17:29:07 2023
step:  300/ 3305 loss:0.1011 imps:84.2 lr: 0.0918 etc:Sun Mar  5 17:29:14 2023
step:  400/ 3305 loss:0.0904 imps:80.8 lr: 0.0890 etc:Sun Mar  5 17:29:40 2023
step:  500/ 3305 loss:0.0851 imps:83.8 lr: 0.0863 etc:Sun Mar  5 17:29:17 2023
step:  600/ 3305 loss:0.0842 imps:86.2 lr: 0.0835 etc:Sun Mar  5 17:28:59 2023
validating ... loss: 0.0713
Epoch 2/5
step:  700/ 3305 loss:0.0735 imps:89.9 lr: 0.0807 etc:Sun Mar  5 17:29:32 2023
step:  800/ 3305 loss:0.0717 imps:97.9 lr: 0.0779 etc:Sun Mar  5 17:29:16 2023
step:  900/ 3305 loss:0.0692 imps:99.3 lr: 0.0751 etc:Sun Mar  5 17:29:04 2023
step: 1000/ 3305 loss:0.0708 imps:99.6 lr: 0.0723 etc:Sun Mar  5 17:28:55 2023
step: 1100/ 3305 loss:0.0653 imps:99.8 lr: 0.0695 etc:Sun Mar  5 17:28:47 2023
step: 1200/ 3305 loss:0.0683 imps:100.1 lr: 0.0666 etc:Sun Mar  5 17:28:41 2023
step: 1300/ 3305 loss:0.0676 imps:100.2 lr: 0.0638 etc:Sun Mar  5 17:28:35 2023
validating ... loss: 0.0595
Epoch 3/5
step: 1400/ 3305 loss:0.0585 imps:95.7 lr: 0.0609 etc:Sun Mar  5 17:28:54 2023
step: 1500/ 3305 loss:0.0587 imps:98.6 lr: 0.0580 etc:Sun Mar  5 17:28:48 2023
step: 1600/ 3305 loss:0.0568 imps:99.3 lr: 0.0551 etc:Sun Mar  5 17:28:43 2023
step: 1700/ 3305 loss:0.0569 imps:99.5 lr: 0.0522 etc:Sun Mar  5 17:28:39 2023
step: 1800/ 3305 loss:0.0577 imps:99.7 lr: 0.0493 etc:Sun Mar  5 17:28:36 2023
step: 1900/ 3305 loss:0.0573 imps:100.1 lr: 0.0463 etc:Sun Mar  5 17:28:32 2023
validating ... loss: 0.0577
Epoch 4/5
step: 2000/ 3305 loss:0.0552 imps:79.5 lr: 0.0433 etc:Sun Mar  5 17:28:45 2023
step: 2100/ 3305 loss:0.0495 imps:97.9 lr: 0.0403 etc:Sun Mar  5 17:28:41 2023
step: 2200/ 3305 loss:0.0500 imps:99.8 lr: 0.0373 etc:Sun Mar  5 17:28:38 2023
step: 2300/ 3305 loss:0.0490 imps:100.5 lr: 0.0343 etc:Sun Mar  5 17:28:34 2023
step: 2400/ 3305 loss:0.0469 imps:101.0 lr: 0.0312 etc:Sun Mar  5 17:28:31 2023
step: 2500/ 3305 loss:0.0472 imps:101.3 lr: 0.0281 etc:Sun Mar  5 17:28:28 2023
step: 2600/ 3305 loss:0.0453 imps:101.9 lr: 0.0249 etc:Sun Mar  5 17:28:25 2023
validating ... loss: 0.0521
Epoch 5/5
step: 2700/ 3305 loss:0.0408 imps:92.7 lr: 0.0217 etc:Sun Mar  5 17:28:35 2023
step: 2800/ 3305 loss:0.0375 imps:97.6 lr: 0.0184 etc:Sun Mar  5 17:28:33 2023
step: 2900/ 3305 loss:0.0399 imps:99.0 lr: 0.0151 etc:Sun Mar  5 17:28:31 2023
step: 3000/ 3305 loss:0.0403 imps:99.4 lr: 0.0117 etc:Sun Mar  5 17:28:29 2023
step: 3100/ 3305 loss:0.0389 imps:99.9 lr: 0.0082 etc:Sun Mar  5 17:28:27 2023
step: 3200/ 3305 loss:0.0398 imps:100.1 lr: 0.0045 etc:Sun Mar  5 17:28:25 2023
step: 3300/ 3305 loss:0.0391 imps:100.1 lr: 0.0003 etc:Sun Mar  5 17:28:23 2023
validating ... loss: 0.0497
step.make_cam: Sun Mar  5 17:28:33 2023
[ 0 5 10 15 20 25 30 35 40 45 50 55 60 65 70 75 80 85 90 95 100 ]
step.eval_cam: Sun Mar  5 17:36:03 2023
{'iou': array([0.79340904, 0.43339399, 0.28451443, 0.43068957, 0.3732199 ,
       0.46653636, 0.63258035, 0.53087464, 0.49901361, 0.28924938,
       0.58386073, 0.403015  , 0.4704532 , 0.4770035 , 0.6101078 ,
       0.52312489, 0.41199299, 0.61636705, 0.44436687, 0.50377719,
       0.47317288]), 'miou': 0.4881296839834721}
step.cam_to_ir_label: Sun Mar  5 17:36:09 2023
[ 0 5 10 15 20 25 30 35 40 45 50 55 60 65 70 75 80 85 90 95 100 ]
step.train_irn: Sun Mar  5 17:51:28 2023
Epoch 1/3
step:    0/  990 loss:0.7177 0.6466 4.0642 0.1678 imps:4.1 lr: 0.1000 etc:Sun Mar  5 20:00:15 2023
step:   50/  990 loss:0.5497 0.4880 3.9782 0.0615 imps:27.8 lr: 0.0954 etc:Sun Mar  5 18:10:28 2023
step:  100/  990 loss:0.4310 0.3812 3.8433 0.1128 imps:29.8 lr: 0.0909 etc:Sun Mar  5 18:09:12 2023
step:  150/  990 loss:0.4120 0.3600 3.6598 0.1537 imps:30.5 lr: 0.0863 etc:Sun Mar  5 18:08:48 2023
step:  200/  990 loss:0.4122 0.3632 3.5841 0.1506 imps:30.8 lr: 0.0816 etc:Sun Mar  5 18:08:37 2023
step:  250/  990 loss:0.4094 0.3556 3.5110 0.1587 imps:31.0 lr: 0.0770 etc:Sun Mar  5 18:08:31 2023
step:  300/  990 loss:0.4000 0.3564 3.3621 0.2026 imps:31.1 lr: 0.0723 etc:Sun Mar  5 18:08:26 2023
Epoch 2/3
step:  350/  990 loss:0.3889 0.3472 3.2033 0.2276 imps:27.2 lr: 0.0675 etc:Sun Mar  5 18:08:31 2023
step:  400/  990 loss:0.3953 0.3473 3.1338 0.2236 imps:32.1 lr: 0.0628 etc:Sun Mar  5 18:08:18 2023
step:  450/  990 loss:0.3840 0.3344 3.1019 0.2236 imps:33.1 lr: 0.0580 etc:Sun Mar  5 18:08:07 2023
step:  500/  990 loss:0.3768 0.3365 3.0857 0.2244 imps:33.5 lr: 0.0531 etc:Sun Mar  5 18:07:59 2023
step:  550/  990 loss:0.3804 0.3307 3.0563 0.2273 imps:33.7 lr: 0.0482 etc:Sun Mar  5 18:07:53 2023
step:  600/  990 loss:0.3838 0.3353 3.0626 0.2124 imps:33.9 lr: 0.0432 etc:Sun Mar  5 18:07:47 2023
step:  650/  990 loss:0.3826 0.3414 3.0324 0.2182 imps:34.0 lr: 0.0382 etc:Sun Mar  5 18:07:42 2023
Epoch 3/3
step:  700/  990 loss:0.3796 0.3373 2.9789 0.2077 imps:30.1 lr: 0.0331 etc:Sun Mar  5 18:07:46 2023
step:  750/  990 loss:0.3759 0.3248 2.9807 0.2101 imps:32.5 lr: 0.0279 etc:Sun Mar  5 18:07:42 2023
step:  800/  990 loss:0.3763 0.3299 2.9864 0.2083 imps:33.2 lr: 0.0226 etc:Sun Mar  5 18:07:38 2023
step:  850/  990 loss:0.3744 0.3333 2.9418 0.2103 imps:33.6 lr: 0.0172 etc:Sun Mar  5 18:07:35 2023
step:  900/  990 loss:0.3759 0.3266 2.9183 0.2113 imps:33.8 lr: 0.0116 etc:Sun Mar  5 18:07:32 2023
step:  950/  990 loss:0.3732 0.3275 2.9224 0.2062 imps:33.9 lr: 0.0056 etc:Sun Mar  5 18:07:30 2023
Analyzing displacements mean ... done.
step.make_ins_seg_labels: Sun Mar  5 18:07:40 2023
[ /media/crj/irn-master/irn-master/step/make_ins_seg_labels.py:122: FutureWarning: The input object of type 'Tensor' is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type 'Tensor', or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  size = np.asarray(pack['size'],dtype=object)
/media/crj/irn-master/irn-master/step/make_ins_seg_labels.py:122: FutureWarning: The input object of type 'Tensor' is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type 'Tensor', or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  size = np.asarray(pack['size'],dtype=object)
/media/crj/irn-master/irn-master/step/make_ins_seg_labels.py:122: FutureWarning: The input object of type 'Tensor' is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type 'Tensor', or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  size = np.asarray(pack['size'],dtype=object)
/media/crj/irn-master/irn-master/step/make_ins_seg_labels.py:122: FutureWarning: The input object of type 'Tensor' is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type 'Tensor', or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  size = np.asarray(pack['size'],dtype=object)
0 5 10 15 20 25 30 35 40 45 50 55 60 65 70 75 80 85 90 95 100 ]
step.eval_ins_seg: Sun Mar  5 18:25:39 2023
0.5iou: {'ap': array([0.37788129, 0.00340851, 0.51796424, 0.2520809 , 0.13841759,
       0.64303435, 0.35582183, 0.63778491, 0.05158271, 0.46350404,
       0.17713863, 0.50068531, 0.55379143, 0.46741671, 0.1975169 ,
       0.06225911, 0.34851463, 0.37714873, 0.47809563, 0.51804212]), 'map': 0.35610447971600834}
over
step.make_sem_seg_labels: Sun Mar  5 18:25:48 2023
[/media/crj/irn-master/irn-master/step/make_sem_seg_labels.py:31: FutureWarning: The input object of type 'Tensor' is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type 'Tensor', or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  orig_img_size = np.asarray(pack['size'],dtype=object)
/media/crj/irn-master/irn-master/step/make_sem_seg_labels.py:31: FutureWarning: The input object of type 'Tensor' is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type 'Tensor', or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  orig_img_size = np.asarray(pack['size'],dtype=object)
0 5 10 15 20 25 30 35 40 45 50 55 60 65 70 75 80 85 90 95 100 ]
step.eval_sem_seg: Sun Mar  5 18:42:18 2023
0.07475845040121165 0.044101771857232186
0.14189766537586085 0.21207564179377986
{'iou': array([0.88113978, 0.70992664, 0.33941454, 0.76843918, 0.60342208,
       0.61571985, 0.82851165, 0.6969862 , 0.76121747, 0.35963751,
       0.79184113, 0.41222134, 0.72169461, 0.75205544, 0.76528255,
       0.68579384, 0.47913727, 0.82349189, 0.58203962, 0.65872581,
       0.56497523]), 'miou': 0.6572225540166069}
